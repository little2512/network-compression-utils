<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Network Compression Utils Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background: #f8f9fa;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .section h3 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .full-width {
            grid-column: 1 / -1;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        textarea, select, input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
            font-family: monospace;
        }
        textarea {
            height: 120px;
            resize: vertical;
        }
        button {
            background: #667eea;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
            font-weight: bold;
            transition: background 0.3s;
        }
        button:hover {
            background: #5a67d8;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .button-secondary {
            background: #48bb78;
        }
        .button-secondary:hover {
            background: #38a169;
        }
        .button-danger {
            background: #f56565;
        }
        .button-danger:hover {
            background: #e53e3e;
        }
        .result {
            background: #f7fafc;
            padding: 20px;
            border-radius: 5px;
            margin-top: 15px;
            border: 1px solid #e2e8f0;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        .stat-value {
            font-size: 1.4em;
            font-weight: bold;
            margin-top: 5px;
        }
        .network-status {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .network-status.good {
            background: #c6f6d5;
            border: 1px solid #9ae6b4;
            color: #22543d;
        }
        .network-status.medium {
            background: #feebc8;
            border: 1px solid #fbd38d;
            color: #7c2d12;
        }
        .network-status.poor {
            background: #fed7d7;
            border: 1px solid #fc8181;
            color: #742a2a;
        }
        .progress-bar {
            width: 100%;
            height: 25px;
            background: #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78, #38a169);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        .tabs {
            display: flex;
            border-bottom: 1px solid #e2e8f0;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }
        .tab.active {
            border-bottom-color: #667eea;
            color: #667eea;
            font-weight: bold;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .format-display {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #dee2e6;
            margin-top: 10px;
            word-break: break-all;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .comparison-table th,
        .comparison-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }
        .comparison-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        .success { color: #38a169; font-weight: bold; }
        .warning { color: #d69e2e; font-weight: bold; }
        .error { color: #e53e3e; font-weight: bold; }
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üöÄ Network Compression Utils - Complete Demo</h1>
        <p>Experience the full power of network-aware data compression with multiple output formats</p>
    </div>

    <div id="network-status" class="network-status">
        <h4>Network Status: <span id="network-type">Detecting...</span></h4>
        <p>Quality Score: <span id="network-quality">-</span>/100 | Description: <span id="network-description">-</span></p>
    </div>

    <div class="container">
        <!-- Data Input Section -->
        <div class="section">
            <h3>üìù Data Input</h3>

            <div class="form-group">
                <label for="data-preset">Data Preset:</label>
                <select id="data-preset">
                    <option value="custom">Custom Data</option>
                    <option value="user-profile">User Profile</option>
                    <option value="product-catalog">Product Catalog</option>
                    <option value="api-response">API Response</option>
                    <option value="large-dataset">Large Dataset</option>
                    <option value="form-data">Form Data</option>
                </select>
            </div>

            <div class="form-group">
                <label for="input-data">Input Data:</label>
                <textarea id="input-data" placeholder="Enter your data here or select a preset..."></textarea>
            </div>

            <div class="form-group">
                <label for="output-format">Output Format:</label>
                <select id="output-format">
                    <option value="urlsearch">URLSearchParams (Query String)</option>
                    <option value="formdata">FormData (Multipart)</option>
                    <option value="string">String (JSON)</option>
                </select>
            </div>

            <div class="form-group">
                <label for="network-override">Override Network Type:</label>
                <select id="network-override">
                    <option value="">Use Actual Network</option>
                    <option value="slow-2g">Slow 2G</option>
                    <option value="2g">2G</option>
                    <option value="3g">3G</option>
                    <option value="4g">4G</option>
                </select>
            </div>

            <div class="form-group">
                <label>
                    <input type="checkbox" id="force-compression"> Force Compression
                </label>
                <label>
                    <input type="checkbox" id="enable-logging" checked> Enable Logging
                </label>
            </div>

            <button onclick="processData()" class="button-secondary">üîÑ Process Data</button>
            <button onclick="clearAll()" class="button-danger">üóëÔ∏è Clear All</button>
        </div>

        <!-- Results Section -->
        <div class="section">
            <h3>üìä Compression Results</h3>

            <div class="tabs">
                <div class="tab active" onclick="showTab('summary')">Summary</div>
                <div class="tab" onclick="showTab('details')">Details</div>
                <div class="tab" onclick="showTab('format')">Format Output</div>
            </div>

            <div id="summary-tab" class="tab-content active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Compression Applied</div>
                        <div class="stat-value" id="stat-compressed">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Original Size</div>
                        <div class="stat-value" id="stat-original-size">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Compressed Size</div>
                        <div class="stat-value" id="stat-compressed-size">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Compression Ratio</div>
                        <div class="stat-value" id="stat-ratio">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Processing Time</div>
                        <div class="stat-value" id="stat-time">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Algorithm Used</div>
                        <div class="stat-value" id="stat-algorithm">-</div>
                    </div>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="compression-progress" style="width: 0%;">
                        0%
                    </div>
                </div>
            </div>

            <div id="details-tab" class="tab-content">
                <div id="result-details" class="result">Results will appear here...</div>
            </div>

            <div id="format-tab" class="tab-content">
                <h4>Output in <span id="format-type">-</span> Format:</h4>
                <div id="format-output" class="format-display">Format output will appear here...</div>
            </div>
        </div>
    </div>

    <!-- System Status -->
    <div class="section full-width">
        <h3>‚öôÔ∏è System Status & Configuration</h3>

        <div class="tabs">
            <div class="tab active" onclick="showSystemTab('overview')">Overview</div>
            <div class="tab" onclick="showSystemTab('network')">Network</div>
            <div class="tab" onclick="showSystemTab('config')">Configuration</div>
            <div class="tab" onclick="showSystemTab('stats')">Statistics</div>
        </div>

        <div id="overview-tab" class="tab-content active">
            <div id="system-overview" class="result">Loading system status...</div>
        </div>

        <div id="network-tab" class="tab-content">
            <div id="network-details" class="result">Network details...</div>
        </div>

        <div id="config-tab" class="tab-content">
            <div id="config-details" class="result">Configuration details...</div>
        </div>

        <div id="stats-tab" class="tab-content">
            <button onclick="showStats()">Refresh Statistics</button>
            <button onclick="resetStats()" class="button-danger">Reset Statistics</button>
            <div id="stats-details" class="result">Compression statistics...</div>
        </div>
    </div>

    <!-- Format Comparison -->
    <div class="section full-width">
        <h3>üîÑ Format Comparison</h3>
        <button onclick="compareFormats()">Compare All Formats</button>
        <div id="format-comparison" class="result">Format comparison will appear here...</div>
    </div>

    <!-- Real-time Monitoring -->
    <div class="section full-width">
        <h3>üìà Real-time Network Monitoring</h3>
        <button onclick="startMonitoring()">Start Monitoring</button>
        <button onclick="stopMonitoring()" class="button-danger">Stop Monitoring</button>
        <div id="monitoring-log" class="result">Monitoring log will appear here...</div>
    </div>

    <script src="../dist/index.umd.js"></script>
    <script>
        let ncu;
        let monitoringInterval;
        let lastResult = null;

        // Initialize the Network Compression Utils
        function initializeNcu() {
            ncu = new NetworkCompressionUtils.NetworkCompressionUtils({
                enableLogging: true,
                thresholds: {
                    'slow-2g': 100,
                    '2g': 500,
                    '3g': 1500,
                    '4g': 3000
                }
            });

            // Add network change listener
            ncu.addNetworkListener((networkInfo) => {
                updateNetworkStatus(networkInfo);
                if (document.getElementById('enable-logging').checked) {
                    logMonitoring(`Network changed to: ${networkInfo.effectiveType}`);
                }
            });

            updateNetworkStatus();
            updateSystemStatus();
            console.log('Network Compression Utils initialized successfully');
        }

        // Load preset data
        function loadPresetData(preset) {
            const presets = {
                'user-profile': {
                    user: {
                        id: 12345,
                        name: 'John Doe',
                        email: 'john.doe@example.com',
                        profile: {
                            bio: 'Software developer with expertise in web technologies and network optimization.',
                            interests: ['coding', 'music', 'travel', 'photography'],
                            experience: [
                                {
                                    company: 'Tech Corp',
                                    role: 'Senior Developer',
                                    years: 5,
                                    technologies: ['JavaScript', 'React', 'Node.js', 'Python']
                                }
                            ]
                        },
                        preferences: {
                            theme: 'dark',
                            language: 'en',
                            notifications: true,
                            privacy: {
                                showEmail: false,
                                showLocation: true,
                                dataSharing: false
                            }
                        }
                    }
                },
                'product-catalog': {
                    catalog: {
                        version: '2.1.0',
                        lastUpdated: new Date().toISOString(),
                        categories: ['Electronics', 'Books', 'Clothing', 'Home & Garden'],
                        products: Array.from({length: 20}, (_, i) => ({
                            id: `PRD-${String(i + 1).padStart(6, '0')}`,
                            name: `Product ${i + 1}`,
                            price: Math.floor(Math.random() * 1000) + 10,
                            description: `This is product number ${i + 1} with detailed description and specifications.`,
                            category: ['Electronics', 'Books', 'Clothing', 'Home & Garden'][i % 4],
                            inStock: Math.random() > 0.3,
                            tags: [`tag${i % 5}`, `category${i % 4}`, `item${i % 10}`],
                            metadata: {
                                weight: Math.random() * 10 + 0.1,
                                dimensions: {
                                    length: Math.random() * 50 + 5,
                                    width: Math.random() * 50 + 5,
                                    height: Math.random() * 30 + 2
                                }
                            }
                        }))
                    }
                }
                },
                'api-response': {
                    success: true,
                    data: {
                        users: Array.from({length: 50}, (_, i) => ({
                            id: i + 1,
                            username: `user${i + 1}`,
                            email: `user${i + 1}@example.com`,
                            profile: {
                                firstName: `FirstName${i}`,
                                lastName: `LastName${i}`,
                                age: 20 + (i % 50),
                                address: {
                                    street: `${123 + i} Main St`,
                                    city: ['New York', 'Los Angeles', 'Chicago', 'Houston', 'Phoenix'][i % 5],
                                    state: 'NY',
                                    zipCode: String(10000 + i * 100)
                                }
                            },
                            activity: {
                                lastLogin: new Date(Date.now() - i * 86400000).toISOString(),
                                loginCount: Math.floor(Math.random() * 1000) + 1,
                                actions: Array.from({length: Math.floor(Math.random() * 10) + 1}, (_, j) => ({
                                    type: ['login', 'view', 'click', 'purchase'][j % 4],
                                    timestamp: new Date(Date.now() - j * 3600000).toISOString()
                                }))
                            }
                        })),
                        pagination: {
                            page: 1,
                            limit: 50,
                            total: 1000,
                            hasMore: true
                        }
                    },
                    message: 'Users retrieved successfully'
                }
                },
                'large-dataset': {
                    dataset: {
                        metadata: {
                            id: 'dataset-' + Date.now(),
                            created: new Date().toISOString(),
                            type: 'performance_metrics',
                            version: '1.0.0'
                        },
                        records: Array.from({length: 100}, (_, i) => ({
                            id: i,
                            timestamp: new Date(Date.now() - i * 1000).toISOString(),
                            metrics: {
                                cpu: Math.random() * 100,
                                memory: Math.random() * 8192,
                                disk: Math.random() * 1024,
                                network: {
                                    upload: Math.random() * 1000,
                                    download: Math.random() * 5000,
                                    latency: Math.random() * 200
                                }
                            },
                            tags: ['production', 'server' + (i % 5), 'region' + (i % 3)],
                            details: {
                                hostname: `server-${i}.example.com`,
                                environment: ['production', 'staging', 'development'][i % 3],
                                version: `v${Math.floor(Math.random() * 5) + 1}.${Math.floor(Math.random() * 10)}.${Math.floor(Math.random() * 10)}`,
                                description: `Performance metrics record number ${i} with detailed system information and performance indicators.`
                            }
                        }))
                    }
                },
                'form-data': {
                    user: {
                        name: 'Jane Smith',
                        email: 'jane.smith@example.com',
                        phone: '+1-555-0123'
                    },
                    survey: {
                        satisfaction: 5,
                        comments: 'Great service! Very satisfied with the experience.',
                        recommendations: ['UI improvements', 'More features', 'Better documentation'],
                        wouldRecommend: true
                    },
                    preferences: {
                        newsletter: true,
                        updates: false,
                        promotions: true,
                        frequency: 'weekly'
                    }
                }
            };

            return presets[preset] || { message: 'Enter your custom data here' };
        }

        // Handle preset selection
        document.getElementById('data-preset').addEventListener('change', function() {
            const preset = this.value;
            if (preset !== 'custom') {
                const data = loadPresetData(preset);
                document.getElementById('input-data').value = JSON.stringify(data, null, 2);
            }
        });

        // Process data with network-aware compression
        function processData() {
            const inputData = document.getElementById('input-data').value;
            const outputFormat = document.getElementById('output-format').value;
            const networkOverride = document.getElementById('network-override').value;
            const forceCompression = document.getElementById('force-compression').checked;

            if (!inputData.trim()) {
                alert('Please enter some data to process');
                return;
            }

            try {
                let data;
                try {
                    data = JSON.parse(inputData);
                } catch {
                    data = inputData;
                }

                const options = {
                    data: data,
                    outputFormat: outputFormat,
                    forceCompression: forceCompression
                };

                if (networkOverride) {
                    options.networkType = networkOverride;
                }

                const result = ncu.compress(options);
                lastResult = result;

                displayResults(result);
                updateSystemStatus();

                if (document.getElementById('enable-logging').checked) {
                    console.log('Compression result:', result);
                }

            } catch (error) {
                alert(`Error processing data: ${error.message}`);
                console.error('Processing error:', error);
            }
        }

        // Display compression results
        function displayResults(result) {
            // Update summary tab
            document.getElementById('stat-compressed').textContent = result.compressed ? 'Yes' : 'No';
            document.getElementById('stat-compressed').className = result.compressed ? 'stat-value success' : 'stat-value warning';

            document.getElementById('stat-original-size').textContent = formatBytes(result.originalSize);
            document.getElementById('stat-compressed-size').textContent = result.compressedSize ? formatBytes(result.compressedSize) : 'N/A';
            document.getElementById('stat-ratio').textContent = result.compressionRatio ? `${(result.compressionRatio * 100).toFixed(1)}%` : 'N/A';
            document.getElementById('stat-time').textContent = `${result.processingTime.toFixed(2)}ms`;
            document.getElementById('stat-algorithm').textContent = result.algorithm.toUpperCase();

            // Update progress bar
            const progressPercentage = result.compressionRatio ? Math.max(0, Math.min(100, result.compressionRatio * 100)) : 0;
            const progressBar = document.getElementById('compression-progress');
            progressBar.style.width = `${progressPercentage}%`;
            progressBar.textContent = `${progressPercentage.toFixed(1)}%`;

            // Update details tab
            document.getElementById('result-details').textContent = JSON.stringify(result, null, 2);

            // Update format tab
            document.getElementById('format-type').textContent = result.outputFormat.toUpperCase();

            let formatDisplay = '';
            if (result.data instanceof URLSearchParams) {
                formatDisplay = result.data.toString();
            } else if (result.data instanceof FormData) {
                const entries = [];
                for (const [key, value] of result.data.entries()) {
                    entries.push(`${key}: ${value instanceof File ? `[File: ${value.name}]` : value}`);
                }
                formatDisplay = entries.join('\n');
            } else {
                formatDisplay = result.data;
            }

            document.getElementById('format-output').textContent = formatDisplay;
        }

        // Update network status display
        function updateNetworkStatus(networkInfo) {
            if (!networkInfo) {
                networkInfo = ncu.getNetworkInfo();
            }

            if (networkInfo) {
                const qualityScore = ncu.getNetworkQualityScore(networkInfo);
                const description = ncu.getNetworkDescription(networkInfo);

                document.getElementById('network-type').textContent = networkInfo.effectiveType.toUpperCase();
                document.getElementById('network-quality').textContent = qualityScore;

                const statusDiv = document.getElementById('network-status');
                statusDiv.className = 'network-status';

                if (qualityScore >= 70) {
                    statusDiv.classList.add('good');
                } else if (qualityScore >= 40) {
                    statusDiv.classList.add('medium');
                } else {
                    statusDiv.classList.add('poor');
                }

                document.getElementById('network-description').textContent = description;
            } else {
                document.getElementById('network-type').textContent = 'Unknown';
                document.getElementById('network-quality').textContent = '-';
                document.getElementById('network-description').textContent = 'Network information not available';
            }
        }

        // Update system status
        function updateSystemStatus() {
            const status = ncu.getSystemStatus();

            const overview = `
System Overview
==============

Network:
  Connected: ${status.network.connected}
  Type: ${status.network.type}
  Quality: ${status.network.quality}/100
  Description: ${status.network.description}

Configuration:
  Auto Compression: ${status.configuration.autoCompressionEnabled ? 'Enabled' : 'Disabled'}
  Default Format: ${status.configuration.defaultFormat}
  Valid: ${status.configuration.isValid ? 'Yes' : 'No'}
  Errors: ${status.configuration.validationErrors.length}

Compression:
  Total Operations: ${status.compression.totalOperations}
  Success Rate: ${(status.compression.successRate * 100).toFixed(1)}%
  Space Saved: ${formatBytes(status.compression.spaceSaved)}
  Average Time: ${status.compression.averageTime.toFixed(2)}ms

Supported Formats: ${status.formats.supported.join(', ')}
            `;

            document.getElementById('system-overview').textContent = overview;

            // Network details
            const networkDetails = JSON.stringify(status.network, null, 2);
            document.getElementById('network-details').textContent = networkDetails;

            // Configuration details
            const configDetails = JSON.stringify(status.configuration, null, 2);
            document.getElementById('config-details').textContent = configDetails;
        }

        // Tab switching functions
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(`${tabName}-tab`).classList.add('active');
            event.target.classList.add('active');
        }

        function showSystemTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('#system-status + .tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('#system-status + .tabs .tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(`${tabName}-tab`).classList.add('active');
            event.target.classList.add('active');

            // Update stats if requested
            if (tabName === 'stats') {
                showStats();
            }
        }

        // Show statistics
        function showStats() {
            const stats = ncu.getCompressionStats();

            const statsText = `
Compression Statistics
====================

Total Compressions: ${stats.totalCompressions}
Successful Compressions: ${stats.successfulCompressions}
Success Rate: ${(stats.successRate * 100).toFixed(1)}%
Total Original Size: ${formatBytes(stats.totalOriginalSize)}
Total Compressed Size: ${formatBytes(stats.totalCompressedSize)}
Overall Compression Ratio: ${(stats.overallCompressionRatio * 100).toFixed(1)}%
Space Saved: ${formatBytes(stats.spaceSaved)}
Average Compression Time: ${stats.averageCompressionTime.toFixed(2)}ms
            `;

            document.getElementById('stats-details').textContent = statsText;
        }

        // Reset statistics
        function resetStats() {
            ncu.resetStats();
            showStats();
            logMonitoring('Statistics reset');
        }

        // Compare all formats
        function compareFormats() {
            const inputData = document.getElementById('input-data').value;
            if (!inputData.trim()) {
                alert('Please enter some data to compare formats');
                return;
            }

            try {
                let data;
                try {
                    data = JSON.parse(inputData);
                } catch {
                    data = inputData;
                }

                const formats = ['urlsearch', 'formdata', 'string'];
                const results = {};

                formats.forEach(format => {
                    const result = ncu.compress({ data, outputFormat: format });
                    results[format] = {
                        success: result.compressed,
                        size: result.compressedSize || result.originalSize,
                        processingTime: result.processingTime,
                        algorithm: result.algorithm
                    };
                });

                displayFormatComparison(results, data);

            } catch (error) {
                alert(`Error comparing formats: ${error.message}`);
            }
        }

        // Display format comparison
        function displayFormatComparison(results, originalData) {
            const originalSize = ncu.getDataSize(originalData);

            let comparisonHTML = `
                <h4>Format Comparison Results</h4>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Format</th>
                            <th>Compressed</th>
                            <th>Size</th>
                            <th>Size Reduction</th>
                            <th>Processing Time</th>
                            <th>Algorithm</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Original</strong></td>
                            <td>-</td>
                            <td>${formatBytes(originalSize)}</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                        </tr>
            `;

            Object.entries(results).forEach(([format, result]) => {
                const reduction = originalSize > 0 ? ((originalSize - result.size) / originalSize * 100).toFixed(1) : 0;
                const statusClass = result.success ? 'success' : 'warning';

                comparisonHTML += `
                    <tr>
                        <td><strong>${format.toUpperCase()}</strong></td>
                        <td class="${statusClass}">${result.success ? 'Yes' : 'No'}</td>
                        <td>${formatBytes(result.size)}</td>
                        <td class="${reduction > 0 ? 'success' : ''}">${reduction}%</td>
                        <td>${result.processingTime.toFixed(2)}ms</td>
                        <td>${result.algorithm.toUpperCase()}</td>
                    </tr>
                `;
            });

            comparisonHTML += '</table>';

            // Find best format
            const bestFormat = Object.entries(results).reduce((best, [format, result]) => {
                if (!best || result.size < best.size) {
                    return { format, result };
                }
                return best;
            }, null);

            if (bestFormat) {
                comparisonHTML += `
                    <p><strong>Recommended Format:</strong> ${bestFormat.format.toUpperCase()}
                    (${formatBytes(bestFormat.result.size)}, ${((originalSize - bestFormat.result.size) / originalSize * 100).toFixed(1)}% reduction)</p>
                `;
            }

            document.getElementById('format-comparison').innerHTML = comparisonHTML;
        }

        // Start real-time monitoring
        function startMonitoring() {
            if (monitoringInterval) {
                clearInterval(monitoringInterval);
            }

            logMonitoring('Started real-time monitoring');

            monitoringInterval = setInterval(() => {
                const networkInfo = ncu.getNetworkInfo();
                const stats = ncu.getCompressionStats();

                const logEntry = `[${new Date().toLocaleTimeString()}] Network: ${networkInfo?.effectiveType || 'unknown'} | Quality: ${ncu.getNetworkQualityScore(networkInfo)}/100 | Operations: ${stats.totalCompressions}`;
                logMonitoring(logEntry);
            }, 5000);
        }

        // Stop monitoring
        function stopMonitoring() {
            if (monitoringInterval) {
                clearInterval(monitoringInterval);
                monitoringInterval = null;
                logMonitoring('Stopped real-time monitoring');
            }
        }

        // Log monitoring messages
        function logMonitoring(message) {
            const logDiv = document.getElementById('monitoring-log');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}\n`;
            logDiv.textContent = logEntry + logDiv.textContent;

            // Keep only last 10 entries
            const lines = logDiv.textContent.split('\n');
            if (lines.length > 10) {
                logDiv.textContent = lines.slice(-10).join('\n');
            }
        }

        // Clear all inputs and results
        function clearAll() {
            document.getElementById('input-data').value = '';
            document.getElementById('data-preset').value = 'custom';
            document.getElementById('result-details').textContent = 'Results will appear here...';
            document.getElementById('format-output').textContent = 'Format output will appear here...';
            document.getElementById('stat-compressed').textContent = '-';
            document.getElementById('stat-original-size').textContent = '-';
            document.getElementById('stat-compressed-size').textContent = '-';
            document.getElementById('stat-ratio').textContent = '-';
            document.getElementById('stat-time').textContent = '-';
            document.getElementById('stat-algorithm').textContent = '-';
            document.getElementById('compression-progress').style.width = '0%';
            document.getElementById('compression-progress').textContent = '0%';
            lastResult = null;
        }

        // Format bytes to human readable format
        function formatBytes(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Initialize on page load
        window.onload = () => {
            initializeNcu();
            logMonitoring('Network Compression Utils demo initialized');
        };
    </script>
</body>
</html>